<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Irmuun | Portfolio</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body id="top">

  <header class="navbar">
    <nav>
      <ul class="nav-list" id="nav-list">
        <li><a href="index.html#top">Home</a></li>
        <li><a href="about.html">About Me</a></li>
        <li><a href="#portfolio">Recent work</a></li>
        <li><a href="mailto:hello@irmuun.dev">Get In Touch</a></li>
      </ul>
      <div class="socials">
        <span>in</span>
        <span>Be</span>
        <span>üê¶</span>
      </div>
    </nav>
  </header>

  <section class="hero">
    <div class="container hero-inner">
      <div class="hero-left">
        <h1 class="name">Irmuun</h1>
        <p class="intro">Hi, I'm Irmuun ‚Äì Portfolio welcome.<br><br></p>
        <a href="about.html" class="cta">Let‚Äôs get started ‚Üí</a>
      </div>
      <div class="hero-right">
        <div class="avatar">
          <img src="img/profile.jpg" alt="Irmuun" />
          <div class="profile-avatar">IM</div>
        </div>
      </div>
    </div>
  </section>

  <section id="portfolio" class="portfolio">
    <h3>Selected Projects</h3>
    <div class="portfolio-controls">
      <div class="filters" role="tablist" aria-label="Project filters">
        <button class="filter" data-filter="all" aria-pressed="true">All</button>
      </div>
      <div class="portfolio-search">
        <input type="search" id="project-search" placeholder="Search projects..." aria-label="Search projects" />
      </div>
    </div>

    <div class="projects-grid" id="projects-grid" aria-live="polite">
      <p class="muted">Loading projects‚Ä¶</p>
    </div>
  </section>

  <div id="project-modal" class="project-modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <button class="modal-close" aria-label="Close project details">√ó</button>
      <h4 id="modal-title"></h4>
      <img id="modal-image" alt="" />
      <p id="modal-desc"></p>
      <a id="modal-link" class="project-cta" target="_blank" rel="noopener">View project</a>
    </div>
  </div>

  
  <script>
    (function () {
      const imgPath = 'img/profile.jpg';
      const imgEl = document.querySelector('.avatar img');
      const fallback = document.querySelector('.profile-avatar');
      const tester = new Image();
      tester.onload = function () {
        imgEl.style.display = 'block';
        fallback.style.display = 'none';
      };
      tester.onerror = function () {
        imgEl.style.display = 'none';
        fallback.style.display = 'flex';
      };
      tester.src = imgPath;
    })();
  </script>

 
  <script>
    (function () {
      const nav = document.querySelector('nav');
      const toggle = document.querySelector('.nav-toggle');
      const navList = document.getElementById('nav-list');
      if (toggle) {
        toggle.addEventListener('click', function () {
          const expanded = this.getAttribute('aria-expanded') === 'true';
          this.setAttribute('aria-expanded', String(!expanded));
          nav.classList.toggle('nav-open');
        });
        navList?.addEventListener('click', function (e) {
          if (e.target.tagName === 'A') {
            toggle.setAttribute('aria-expanded', 'false');
            nav.classList.remove('nav-open');
          }
        });
        document.addEventListener('keydown', function (e) {
          if (e.key === 'Escape') {
            toggle.setAttribute('aria-expanded', 'false');
            nav.classList.remove('nav-open');
          }
        });
      }
    })();
  </script>


  <script>
    (function () {
      document.querySelectorAll('a[href$="#top"]').forEach(a => {
        a.addEventListener('click', function (e) {
          try {
            const url = new URL(this.href, location.href);
            if (url.pathname === location.pathname) {
              e.preventDefault();
              window.scrollTo({ top: 0, behavior: 'smooth' });
              history.replaceState(null, '', url.hash);
            }
          } catch { }
        });
      });
    })();
  </script>


  <script>
    (function () {

      async function fetchProjects() {
        try {
          const res = await fetch('projects.json');
          if (!res.ok) throw new Error();
          return await res.json();
        } catch {
          console.warn('Failed to load projects.json, using fallback');
          return [];
        }
      }

      function createCard(p) {
        const el = document.createElement('article');
        el.className = 'project-card';
        el.setAttribute('data-category', p.category);
        el.tabIndex = 0;
        el.innerHTML = `
          <div class="project-img-wrap">
            ${p.image
              ? `<img src="${p.image}" alt="${p.title}" loading="lazy">`
              : `<div class="project-img-fallback">${p.title.charAt(0)}</div>`
            }
          </div>
          <div class="project-body">
            <h4 class="project-title">${p.title}</h4>
            <p class="project-category">${p.category}</p>
            <p class="project-desc">${p.description}</p>
            <div class="project-tags">
              ${(p.tags || []).map(t => `<span class="tag">${t}</span>`).join('')}
            </div>
            <div class="project-actions">
              <button class="btn-details" data-id="${p.id}">Details</button>
              ${p.link ? `<a class="project-cta" href="${p.link}" target="_blank" rel="noopener">Live</a>` : ''}
            </div>
          </div>
        `;
        return el;
      }

      async function renderProjects() {
        const data = await fetchProjects();
        const grid = document.getElementById('projects-grid');
        const filtersWrap = document.querySelector('.filters');
        const search = document.getElementById('project-search');

        grid.innerHTML = '';

        if (!data.length) {
          grid.innerHTML = '<p class="muted">No projects found</p>';
          return;
        }

   
        const cats = [...new Set(data.map(p => p.category))];
        filtersWrap.innerHTML =
          `<button class="filter" data-filter="all" aria-pressed="true">All</button>` +
          cats.map(c => `<button class="filter" data-filter="${c}">${c}</button>`).join('');

        function applyFilters() {
          const active = document.querySelector('.filter[aria-pressed="true"]')?.dataset.filter || 'all';
          const q = (search.value || '').toLowerCase();

          const filtered = data.filter(p => {
            const byCat = active === 'all' || p.category === active;
            const byQuery = !q || (p.title + p.description + (p.tags || []).join(' ')).toLowerCase().includes(q);
            return byCat && byQuery;
          });

          grid.innerHTML = filtered.map(p => createCard(p).outerHTML).join('');
          attachCardEvents();
        }

        applyFilters();
        filtersWrap.addEventListener('click', e => {
          if (e.target.classList.contains('filter')) {
            filtersWrap.querySelectorAll('.filter').forEach(b => b.setAttribute('aria-pressed', 'false'));
            e.target.setAttribute('aria-pressed', 'true');
            applyFilters();
          }
        });

        search.addEventListener('input', debounce(applyFilters, 200));
        window.__projectsCache = data;
      }

      let lastFocused = null;

      function attachCardEvents() {
        document.querySelectorAll('.btn-details').forEach(btn => {
          btn.addEventListener('click', () => openModal(btn.dataset.id));
        });
      }

      async function openModal(id) {
        const data = window.__projectsCache || await fetchProjects();
        const p = data.find(x => x.id === id);
        if (!p) return;

        const modal = document.getElementById('project-modal');
        lastFocused = document.activeElement;

        document.getElementById('modal-title').textContent = p.title;
        const img = document.getElementById('modal-image');
        if (p.image) {
          img.src = p.image;
          img.style.display = 'block';
        } else img.style.display = 'none';

        document.getElementById('modal-desc').textContent = p.description;
        const link = document.getElementById('modal-link');
        if (p.link) {
          link.href = p.link;
          link.style.display = 'inline-block';
        } else link.style.display = 'none';

        modal.setAttribute('aria-hidden', 'false');
        modal.classList.add('open');
        document.body.style.overflow = 'hidden';
      }

      function debounce(fn, ms) {
        let t;
        return (...args) => {
          clearTimeout(t);
          t = setTimeout(() => fn(...args), ms);
        };
      }

      renderProjects();
    })();
  </script>

</body>
</html>
